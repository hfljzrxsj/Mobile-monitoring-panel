System.register(["./tslib-legacy-IN4nW4qJ.js","./lodash-legacy-J2IeIaWM.js"],(function(n,t){"use strict";var e,r,i,u,o,a,c,s;return{setters:[function(n){e=n._,r=n.a,i=n.b,u=n.c,o=n.d,a=n.e},function(n){c=n.d,s=n.t}],execute:function(){n("b",(function(n,t,u){return function(n,t,u){void 0===t&&(t={}),void 0===u&&(u=[]);var o=t.manual,c=void 0!==o&&o,s=a(t,["manual"]),f=i({manual:c},s),d=m(n),v=L(),h=p((function(){var n=u.map((function(n){var t;return null===(t=null==n?void 0:n.onInit)||void 0===t?void 0:t.call(n,f)})).filter(Boolean);return new I(d,f,v,Object.assign.apply(Object,e([{}],r(n),!1)))}),[]);return h.options=f,h.pluginImpls=u.map((function(n){return n(h,f)})),F((function(){if(!c){var n=h.state.params||t.defaultParams||[];h.run.apply(h,e([],r(n),!1))}})),g((function(){h.cancel()})),{loading:h.state.loading,data:h.state.data,error:h.state.error,params:h.state.params||[],cancel:l(h.cancel.bind(h)),refresh:l(h.refresh.bind(h)),refreshAsync:l(h.refreshAsync.bind(h)),run:l(h.run.bind(h)),runAsync:l(h.runAsync.bind(h)),mutate:l(h.mutate.bind(h))}}(n,t,e(e([],r(u||[]),!1),[S,T,j,B,D,h,P,M],!1))}));var t=function(n){return"function"==typeof n};function l(n){var t=React.useRef(n);t.current=React.useMemo((function(){return n}),[n]);var e=React.useRef();return e.current||(e.current=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.current.apply(this,n)}),e.current}var f,d=n("c",(f=React.useEffect,function(n,t){var e=React.useRef(!1);f((function(){return function(){e.current=!1}}),[]),f((function(){if(e.current)return n();e.current=!0}),t)})),v=function(n,t){var i=t.manual,u=t.ready,o=void 0===u||u,a=t.defaultParams,c=void 0===a?[]:a,s=t.refreshDeps,l=void 0===s?[]:s,f=t.refreshDepsAction,v=React.useRef(!1);return v.current=!1,d((function(){!i&&o&&(v.current=!0,n.run.apply(n,e([],r(c),!1)))}),[o]),d((function(){v.current||i||(v.current=!0,f?f():n.refresh())}),e([],r(l),!1)),{onBefore:function(){if(!o)return{stopNow:!0}}}};v.onInit=function(n){var t=n.ready,e=void 0===t||t;return{loading:!n.manual&&e}};var h=v;function p(n,t){var e=React.useRef({deps:t,obj:void 0,initialized:!1}).current;return!1!==e.initialized&&function(n,t){if(n===t)return!0;for(var e=0;e<n.length;e++)if(!Object.is(n[e],t[e]))return!1;return!0}(e.deps,t)||(e.deps=t,e.obj=n(),e.initialized=!0),e.obj}function m(n){var t=React.useRef(n);return t.current=n,t}var g=function(n){var t=m(n);React.useEffect((function(){return function(){t.current()}}),[])},y=new Map,R=new Map,b={},w=function(n,t){return b[n]||(b[n]=[]),b[n].push(t),function(){var e=b[n].indexOf(t);b[n].splice(e,1)}},P=function(n,t){var u=t.cacheKey,o=t.cacheTime,a=void 0===o?3e5:o,c=t.staleTime,s=void 0===c?0:c,l=t.setCache,f=t.getCache,d=React.useRef(),v=React.useRef(),h=function(n,t){l?l(t):function(n,t,e){var r=y.get(n);(null==r?void 0:r.timer)&&clearTimeout(r.timer);var u=void 0;t>-1&&(u=setTimeout((function(){y.delete(n)}),t)),y.set(n,i(i({},e),{timer:u}))}(n,a,t),function(n,t){b[n]&&b[n].forEach((function(n){return n(t)}))}(n,t.data)},m=function(n,t){return void 0===t&&(t=[]),f?f(t):function(n){return y.get(n)}(n)};return p((function(){if(u){var t=m(u);t&&Object.hasOwnProperty.call(t,"data")&&(n.state.data=t.data,n.state.params=t.params,(-1===s||(new Date).getTime()-t.time<=s)&&(n.state.loading=!1)),d.current=w(u,(function(t){n.setState({data:t})}))}}),[]),g((function(){var n;null===(n=d.current)||void 0===n||n.call(d)})),u?{onBefore:function(n){var t=m(u,n);return t&&Object.hasOwnProperty.call(t,"data")?-1===s||(new Date).getTime()-t.time<=s?{loading:!1,data:null==t?void 0:t.data,error:void 0,returnNow:!0}:{data:null==t?void 0:t.data,error:void 0}:{}},onRequest:function(n,t){var i=function(n){return R.get(n)}(u);return i&&i!==v.current||(i=n.apply(void 0,e([],r(t),!1)),v.current=i,function(n,t){R.set(n,t),t.then((function(t){return R.delete(n),t})).catch((function(){R.delete(n)}))}(u,i)),{servicePromise:i}},onSuccess:function(t,e){var r;u&&(null===(r=d.current)||void 0===r||r.call(d),h(u,{data:t,params:e,time:(new Date).getTime()}),d.current=w(u,(function(t){n.setState({data:t})})))},onMutate:function(t){var e;u&&(null===(e=d.current)||void 0===e||e.call(d),h(u,{data:t,params:n.state.params,time:(new Date).getTime()}),d.current=w(u,(function(t){n.setState({data:t})})))}}:{}},S=function(n,t){var i=t.debounceWait,u=t.debounceLeading,o=t.debounceTrailing,a=t.debounceMaxWait,s=React.useRef(),l=React.useMemo((function(){var n={};return void 0!==u&&(n.leading=u),void 0!==o&&(n.trailing=o),void 0!==a&&(n.maxWait=a),n}),[u,o,a]);return React.useEffect((function(){if(i){var t=n.runAsync.bind(n);return s.current=c((function(n){n()}),i,l),n.runAsync=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return new Promise((function(i,u){var o;null===(o=s.current)||void 0===o||o.call(s,(function(){t.apply(void 0,e([],r(n),!1)).then(i).catch(u)}))}))},function(){var e;null===(e=s.current)||void 0===e||e.cancel(),n.runAsync=t}}}),[i,l]),i?{onCancel:function(){var n;null===(n=s.current)||void 0===n||n.cancel()}}:{}},T=function(n,t){var e=t.loadingDelay,r=t.ready,i=React.useRef();if(!e)return{};var u=function(){i.current&&clearTimeout(i.current)};return{onBefore:function(){return u(),!1!==r&&(i.current=setTimeout((function(){n.setState({loading:!0})}),e)),{loading:!1}},onFinally:function(){u()},onCancel:function(){u()}}},E=!("undefined"==typeof window||!window.document||!window.document.createElement);function A(){return!E||"hidden"!==document.visibilityState}var O=[];E&&window.addEventListener("visibilitychange",(function(){if(A())for(var n=0;n<O.length;n++)(0,O[n])()}),!1);var j=function(n,t){var e=t.pollingInterval,r=t.pollingWhenHidden,i=void 0===r||r,u=t.pollingErrorRetryCount,o=void 0===u?-1:u,a=React.useRef(),c=React.useRef(),s=React.useRef(0),l=function(){var n;a.current&&clearTimeout(a.current),null===(n=c.current)||void 0===n||n.call(c)};return d((function(){e||l()}),[e]),e?{onBefore:function(){l()},onError:function(){s.current+=1},onSuccess:function(){s.current=0},onFinally:function(){-1===o||-1!==o&&s.current<=o?a.current=setTimeout((function(){var t;i||A()?n.refresh():c.current=(t=function(){n.refresh()},O.push(t),function(){var n=O.indexOf(t);O.splice(n,1)})}),e):s.current=0},onCancel:function(){l()}}:{}},C=[];if(E){var H=function(){if(A()&&(!E||void 0===navigator.onLine||navigator.onLine))for(var n=0;n<C.length;n++)(0,C[n])()};window.addEventListener("visibilitychange",H,!1),window.addEventListener("focus",H,!1)}var B=function(n,t){var i=t.refreshOnWindowFocus,u=t.focusTimespan,o=void 0===u?5e3:u,a=React.useRef(),c=function(){var n;null===(n=a.current)||void 0===n||n.call(a)};return React.useEffect((function(){if(i){var t=(s=n.refresh.bind(n),l=o,f=!1,function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];f||(f=!0,s.apply(void 0,e([],r(n),!1)),setTimeout((function(){f=!1}),l))});a.current=(u=function(){t()},C.push(u),function(){var n=C.indexOf(u);n>-1&&C.splice(n,1)})}var u,s,l,f;return function(){c()}}),[i,o]),g((function(){c()})),{}},M=function(n,t){var e=t.retryInterval,r=t.retryCount,i=React.useRef(),u=React.useRef(0),o=React.useRef(!1);return r?{onBefore:function(){o.current||(u.current=0),o.current=!1,i.current&&clearTimeout(i.current)},onSuccess:function(){u.current=0},onError:function(){if(u.current+=1,-1===r||u.current<=r){var t=null!=e?e:Math.min(1e3*Math.pow(2,u.current),3e4);i.current=setTimeout((function(){o.current=!0,n.refresh()}),t)}else u.current=0},onCancel:function(){u.current=0,i.current&&clearTimeout(i.current)}}:{}},D=function(n,t){var i=t.throttleWait,u=t.throttleLeading,o=t.throttleTrailing,a=React.useRef(),c={};return void 0!==u&&(c.leading=u),void 0!==o&&(c.trailing=o),React.useEffect((function(){if(i){var t=n.runAsync.bind(n);return a.current=s((function(n){n()}),i,c),n.runAsync=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return new Promise((function(i,u){var o;null===(o=a.current)||void 0===o||o.call(a,(function(){t.apply(void 0,e([],r(n),!1)).then(i).catch(u)}))}))},function(){var e;n.runAsync=t,null===(e=a.current)||void 0===e||e.cancel()}}}),[i,u,o]),i?{onCancel:function(){var n;null===(n=a.current)||void 0===n||n.cancel()}}:{}},F=n("a",(function(n){React.useEffect((function(){null==n||n()}),[])})),L=function(){var n=r(React.useState({}),2)[1];return React.useCallback((function(){return n({})}),[])},x=function(){function n(n,t,e,r){void 0===r&&(r={}),this.serviceRef=n,this.options=t,this.subscribe=e,this.initState=r,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=i(i(i({},this.state),{loading:!t.manual}),r)}return n.prototype.setState=function(n){void 0===n&&(n={}),this.state=i(i({},this.state),n),this.subscribe()},n.prototype.runPluginHandler=function(n){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var u=this.pluginImpls.map((function(i){var u;return null===(u=i[n])||void 0===u?void 0:u.call.apply(u,e([i],r(t),!1))})).filter(Boolean);return Object.assign.apply(Object,e([{}],r(u),!1))},n.prototype.runAsync=function(){for(var n,t,c,s,l,f,d,v,h,p,m=[],g=0;g<arguments.length;g++)m[g]=arguments[g];return u(this,void 0,void 0,(function(){var u,g,y,R,b,w,P,S,T,E,A;return o(this,(function(o){switch(o.label){case 0:if(this.count+=1,u=this.count,g=this.runPluginHandler("onBefore",m),y=g.stopNow,R=void 0!==y&&y,b=g.returnNow,w=void 0!==b&&b,P=a(g,["stopNow","returnNow"]),R)return[2,new Promise((function(){}))];if(this.setState(i({loading:!0,params:m},P)),w)return[2,Promise.resolve(P.data)];null===(t=(n=this.options).onBefore)||void 0===t||t.call(n,m),o.label=1;case 1:return o.trys.push([1,3,,4]),(S=this.runPluginHandler("onRequest",this.serviceRef.current,m).servicePromise)||(S=(A=this.serviceRef).current.apply(A,e([],r(m),!1))),[4,S];case 2:return T=o.sent(),u!==this.count?[2,new Promise((function(){}))]:(this.setState({data:T,error:void 0,loading:!1}),null===(s=(c=this.options).onSuccess)||void 0===s||s.call(c,T,m),this.runPluginHandler("onSuccess",T,m),null===(f=(l=this.options).onFinally)||void 0===f||f.call(l,m,T,void 0),u===this.count&&this.runPluginHandler("onFinally",m,T,void 0),[2,T]);case 3:if(E=o.sent(),u!==this.count)return[2,new Promise((function(){}))];throw this.setState({error:E,loading:!1}),null===(v=(d=this.options).onError)||void 0===v||v.call(d,E,m),this.runPluginHandler("onError",E,m),null===(p=(h=this.options).onFinally)||void 0===p||p.call(h,m,void 0,E),u===this.count&&this.runPluginHandler("onFinally",m,void 0,E),E;case 4:return[2]}}))}))},n.prototype.run=function(){for(var n=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.runAsync.apply(this,e([],r(t),!1)).catch((function(t){n.options.onError||console.error(t)}))},n.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},n.prototype.refresh=function(){this.run.apply(this,e([],r(this.state.params||[]),!1))},n.prototype.refreshAsync=function(){return this.runAsync.apply(this,e([],r(this.state.params||[]),!1))},n.prototype.mutate=function(n){var e=t(n)?n(this.state.data):n;this.runPluginHandler("onMutate",e),this.setState({data:e})},n}(),I=x;n("u",(function(n){var e=r(React.useState(n),2),u=e[0],o=e[1];return[u,React.useCallback((function(n){o((function(e){var r=t(n)?n(e):n;return r?i(i({},e),r):e}))}),[])]}))}}}));
